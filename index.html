<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Frank Cheng&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="Frank Cheng's blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Frank Cheng's blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Frank Cheng's blog">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="Frank Cheng&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  

</head>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Frank Cheng&#39;s blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-S-O-L-I-D之开闭原则" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/06/S-O-L-I-D之开闭原则/" class="article-date">
  <time datetime="2015-11-06T03:26:04.000Z" itemprop="datePublished">2015-11-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/06/S-O-L-I-D之开闭原则/">S.O.L.I.D之开闭原则</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="开闭原则">开闭原则</h2><h3 id="什么是开闭原则">什么是开闭原则</h3><p><code>在面向对象编程领域中，开闭原则规定“软件中的对象（类，模块，函数等等）应该对于扩展是开放的，但是对于修改是封闭的”</code></p>
<p>换句话说，开闭原则做了一件很神器的事情：在我们对软件功能修改的时候, 并没有对原来的类进行修改，但是确实对软件的功能进行了修改。</p>
<h3 id="如何做到开闭">如何做到开闭</h3><p><strong>模板方法</strong></p>
<p>在android里面所有的视图类都集成于View。</p>
<p>View的结构如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">View</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">draw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//code</span></span><br><span class="line">        onDraw(canvas);</span><br><span class="line">        <span class="comment">//code</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这时候你就可以继承View，来绘制你所需要的图形。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyView</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="annotation">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        drawTriangle();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>装饰者模式</strong></p>
<p>java中的io类。</p>
<p>如果你需要对一个InputStream加上从文件读取的功能，那么就用FileInputStream进行包装</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">InputStream stream = <span class="keyword">new</span> InputStream()</span><br><span class="line">FileInputStream fis = <span class="keyword">new</span> FileInputStream(stream);</span><br></pre></td></tr></table></figure>
<p>inputStream的代码逻辑没有被改写，但是你现在获取到了新的，对文件操作的能力。</p>
<h3 id="开闭原则的好处">开闭原则的好处</h3><p>更好的保证了类的内聚，在修改代码之后不需要对类进行重新编译。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/06/S-O-L-I-D之开闭原则/" data-id="cign6pnba0003pi9k631bfgbe" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CleanCode/">CleanCode</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/团队分享/">团队分享</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-解决jenkins没法发送邮件到gmail的问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/05/解决jenkins没法发送邮件到gmail的问题/" class="article-date">
  <time datetime="2015-11-05T06:59:50.000Z" itemprop="datePublished">2015-11-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/05/解决jenkins没法发送邮件到gmail的问题/">解决jenkins没法发送邮件到gmail的问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>前段时间搞了个jenkins服务器跑测试用例，但是很奇怪的事情是用它自带的smtp服务器进行发送不够稳定，而且不能发送到gmail（<del>原因未知</del>）。</p>
<p>就这样忍受了好长一段时间之后我终于受不了了，然后放狗去google上搜了一圈，然后折腾了一下终于找到解决方法如下：</p>
<h3 id="设置Admin_Email_Address">设置Admin Email Address</h3><p>设置的地方在， 系统管理 -&gt; 系统设置 -&gt; Jenkins Location ， 如下图</p>
<p><img src="/QQ20151105-0@2x.png" alt=""></p>
<p>地址填写你的smtp服务器对应的邮件账号的地址</p>
<h3 id="配置smtp服务器">配置smtp服务器</h3><p>还是在系统设置界面，最下面配置。smtp服务器的配置方法可以去你对应的电子邮件提供商的官网查。</p>
<p><strong>如果是qq这种垃圾邮箱的话，还要在设置里面开启smtp权限</strong></p>
<p><img src="/QQ20151105-3@2x.png" alt=""></p>
<p><img src="/QQ20151105-4@2x.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/05/解决jenkins没法发送邮件到gmail的问题/" data-id="cign6pnau0000pi9k78erlws6" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CI/">CI</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-mongoose中populate" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/11/05/mongoose中populate/" class="article-date">
  <time datetime="2015-11-05T02:50:51.000Z" itemprop="datePublished">2015-11-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/11/05/mongoose中populate/">mongoose中populate</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>之前一直很想不通mongoose里面的populate到底做了什么事情，然后用populate和自己手动<code>findById</code>有什么区别。因为mongodb里面没有join，我一直希望populate能够带来效率上的提升。</p>
<h3 id="Populate源码">Populate源码</h3><p>地址在<a href="https://github.com/Automattic/mongoose/blob/c76effbf2c9a6f7f1e6e7cc359a1b7d04a526e14/lib/model.js#L2264" target="_blank" rel="external">这里</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  mod.Model.find(match, select, mod.options.options, next.bind(<span class="keyword">this</span>, mod.options, assignmentOpts));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">next</span>(<span class="params">options, assignmentOpts, err, valsFromDb</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">return</span> promise.resolve(err);</span><br><span class="line">  vals = vals.concat(valsFromDb);</span><br><span class="line">  <span class="keyword">if</span> (--_remaining === <span class="number">0</span>) &#123;</span><br><span class="line">    promise.resolve(err, vals, options, assignmentOpts);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们就看最后的这几行。</p>
<p>从方法体上，我们可以看到pouplate是通过<code>cb</code>来进行回调的。但是，由于中间用了promise对<code>cb</code>进行了一次封装，所以最终的回调发生在next函数中的<code>promise.resolve(err, vals, options, assignmentOpts);</code></p>
<p>这样子，问题就变得简单了。populate的实现过程是，首先组件好对待populate的信息的查询和排序操作，然后用<code>mod.Model.find</code>进行第一次查询，查询成功之后，next方法会被调用到，然后实现数据的填充。</p>
<h2 id="结论">结论</h2><p>populate也就是普通的对每个条目的查询，效率和手动查询，然后再在替换并没有提升。所以以后大家在对mongoose populate和手动populate进行选择的时候就不用纠结了啊。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/11/05/mongoose中populate/" data-id="cign6pnb80002pi9k7134mr9t" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Node-js/">Node.js</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-teamshare-SRP" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/10/30/teamshare-SRP/" class="article-date">
  <time datetime="2015-10-30T03:56:45.000Z" itemprop="datePublished">2015-10-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/30/teamshare-SRP/">teamshare-SRP</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="SRP">SRP</h1><p>SRP is short for single responsible principle. It decribes when we build software, we should make class have only one reason to change. When achived this, it will help us to seprete concern. It doesn’t mean a method should do only one thing, but only have one reason to change.</p>
<h3 id="Code_example">Code example</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#10;@implement Rectangle &#10;- (void) draw&#10;&#123;&#10;    code&#10;&#125;&#10;&#10;- (CGFloat)area&#10;&#123;&#10;    code&#10;&#125;&#10;@end</span><br></pre></td></tr></table></figure>
<p>If we change the draw style, the <code>Rectangle</code> will be changed. If area calculating algorithm changes, it also will be changed.</p>
<p>Better design:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@implement Rectangle&#10;- (void) draw&#10;&#123;&#10;    code&#10;&#125;&#10;@end&#10;&#10;@implent GeometricRectangle&#10;+ (CGFloat)area:(Rectangle *)rect&#10;&#123;&#10;    code&#10;&#125;&#10;@end</span><br></pre></td></tr></table></figure>
<h3 id="What_is_responsibility">What is responsibility</h3><p>Motive for changing a class. If you can think of more than one motive for changing a class, then that class has more than one responsibilty.</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@interface Modem&#10;&#123;&#10;    - (void)dial:(NSString)number;&#10;    - (void)hangup;&#10;    - (void)send:(NSString)singleCharacter;&#10;    - (void)recv;&#10;&#125;</span><br></pre></td></tr></table></figure>
<p>We can sperate it into two category. One is connection. So dial and hangup belows to this category. The other is data communication. It contains send and recv.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2015/10/30/teamshare-SRP/" data-id="cign6pnb60001pi9ki3xlvkcu" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CleanCode/">CleanCode</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/团队分享/">团队分享</a></li></ul>

    </footer>
  </div>
  
</article>


  
  
</section>
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CI/">CI</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CleanCode/">CleanCode</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Node-js/">Node.js</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/团队分享/">团队分享</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CI/" style="font-size: 10px;">CI</a> <a href="/tags/CleanCode/" style="font-size: 20px;">CleanCode</a> <a href="/tags/Node-js/" style="font-size: 10px;">Node.js</a> <a href="/tags/团队分享/" style="font-size: 20px;">团队分享</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">October 2015</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/11/06/S-O-L-I-D之开闭原则/">S.O.L.I.D之开闭原则</a>
          </li>
        
          <li>
            <a href="/2015/11/05/解决jenkins没法发送邮件到gmail的问题/">解决jenkins没法发送邮件到gmail的问题</a>
          </li>
        
          <li>
            <a href="/2015/11/05/mongoose中populate/">mongoose中populate</a>
          </li>
        
          <li>
            <a href="/2015/10/30/teamshare-SRP/">teamshare-SRP</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2015 Frank Cheng<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>